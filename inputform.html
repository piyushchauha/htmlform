<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>input form</title>
  </head>
  <body>
    <div id="maincontainer"></div>
    <div id="inputcontainer"></div>
    <div id="optioncontainer"></div>

    <div id="resultcontainer"></div>
    <div id="btncontainer"></div>
    <div id="displaytable"></div>
  </body>
  <script>
    let data1 = [];
    let data = [];
    let sub1 = document.createElement("button");
    let table = document.createElement("table");
    let tbody = document.createElement("tbody");
    let dropdown = document.getElementById("maincontainer");
    let inputcontainer = document.getElementById("inputcontainer");
    let resultcontainer = document.getElementById("resultcontainer");
    let btncontainer = document.getElementById("btncontainer");
    let optioncontainer = document.getElementById("optioncontainer");
    let selectedvalue = "";
    // let inputattribute = {};
    // let optionstore = [];
    let myobject = [];
    let currentoptions = [];

    table.style.border = "1px solid black";

    let inputdata1 = [
      {
        label: "Input",
        value: "Input",
        type: "button",
        id: "input",
      },
      {
        label: "Select the input",
        id: "inputselect",
        type: "dropdown",
        options: [
          { label: "Select the input", value: "", id: "select" },
          { label: "text", id: "texte", type: "text", value: "text" },
          { label: "tel", id: "tele", type: "tel", value: "tel" },
          { label: "email", id: "emaile", type: "email", value: "email" },
          {
            label: "password",
            id: "passe",
            type: "password",
            value: "password",
          },
          {
            label: "Radio",
            id: "radio",
            type: "radio",
            value: "radio",
          },
          {
            label: "checkbox",
            id: "checkbox",
            type: "checkbox",
            value: "checkbox",
          },
          {
            label: "dropdown",
            id: "dropdown",
            type: "dropdown",
            value: "dropdown",
          },
        ],
      },
    ];

    let attributedata1 = [
      {
        label: "Name",
        type: "text",
        inf: "name",
      },
      {
        label: "Value",
        type: "text",
        inf: "value",
      },
      {
        label: "Id",
        type: "text",
        inf: "id",
      },
    ];

    function createinput() {
      for (i = 0; i < inputdata1.length; i++) {
        let label = document.createElement("label");
        label.setAttribute("for", inputdata1[i].id);
        dropdown.append(label);

        if (!inputdata1[i].options) {
          let input = document.createElement("input");
          input.setAttribute("id", inputdata1[i].id);
          input.setAttribute("type", inputdata1[i].type);
          input.setAttribute("value", inputdata1[i].value);
          dropdown.append(input);
        }

        if (inputdata1[i].type == "dropdown") {
          let select = document.createElement("select");
          select.setAttribute("id", inputdata1[i].id);
          dropdown.append(select);
          for (j = 0; j < inputdata1[i].options.length; j++) {
            let options = document.createElement("option");
            options.setAttribute("value", inputdata1[i].options[j].value);
            options.setAttribute("id", inputdata1[i].options[j].id);
            options.innerHTML = inputdata1[i].options[j].label;
            options.setAttribute("value", inputdata1[i].options[j].value);
            select.append(options);
          }

          input.addEventListener("click", inputselect);
          select.addEventListener("click", inputfield);
        }
      }
    }

    function inputselect() {
      inputcontainer.innerHTML = "";
      // resultcontainer.innerHTML = "";
      for (i = 0; i < attributedata1.length; i++) {
        let label1 = document.createElement("label");
        label1.innerHTML = attributedata1[i].label + "<br>";

        let input1 = document.createElement("input");

        input1.setAttribute(attributedata1[i].type, "text");
        input1.setAttribute("id", attributedata1[i].inf);

        inputcontainer.append(label1);
        inputcontainer.append(input1);
        inputcontainer.append(document.createElement("br"));
      }

      if (
        selectedvalue === "radio" ||
        selectedvalue === "checkbox" ||
        selectedvalue === "dropdown"
      ) {
        optioncreation();
      }

      inputcontainer.append(document.createElement("br"));
      let create = document.createElement("button");
      create.innerHTML = "Create";
      create.style.margin = "20px";
      inputcontainer.append(create);
      create.addEventListener("click", createdfield);
    }

    function optioncreation() {
      // inputcontainer.innerHTML = "";
      // optionstore = [];
      // let options = [];
      // let optionstore = [];

      let btn = document.createElement("button");
      btn.innerHTML = "Add Options";

      let inputoption;
      inputcontainer.append(btn);

      let subbtn = document.createElement("button");
      subbtn.innerHTML = "save options";

      btn.addEventListener("click", () => {
        let inputoption = document.createElement("input");
        inputoption.setAttribute("type", "text");
        inputoption.setAttribute("placeholder", "Enter the options");

        optioncontainer.append(inputoption);

        subbtn.addEventListener("click", () => {
          const optionvalue = inputoption.value;

          let inputtype = document.createElement("input");

          if (selectedvalue === "dropdown") {
            inputtype = document.createElement("select");
            let opt = document.createElement("option");
            opt.value = optionvalue;
            opt.innerText = optionvalue;
            inputtype.append(opt);
            resultcontainer.append(inputtype);
          } else if (selectedvalue == "checkbox") {
            inputtype.setAttribute("type", "checkbox");
          } else if (selectedvalue == "radio") {
            inputtype.setAttribute("type", "radio");
          }

          for (i = 0; i < currentoptions.length; i++) {
            inputtype.setAttribute("id", currentoptions[i]);
            inputtype.setAttribute("value", currentoptions[i]);
          }
          for (i = 0; i < data1.length; i++) {
            inputtype.setAttribute("name", data1[i].name);
            // label1 = document.createElement("label");
            // label1.innerHTML = data1[i].name;

            // console.log(data1[i].name);
          }

          let newlabel = document.createElement("label");
          newlabel.textContent = optionvalue;

          // resultcontainer.append(label1);
          resultcontainer.append(inputtype);
          resultcontainer.append(newlabel);

          inputoption.value = "";

          inputoption.remove();
          // inputattribute.gender = optionvalue;
          currentoptions.push(optionvalue);
          // inputattribute.option = options;
          // console.log(options);
          // console.log(inputattribute);
          // optionstore.push(optionvalue);
          // console.log(optionstore);
        });
      });

      inputcontainer.append(subbtn);

      inputcontainer.append(btn);
    }

    function inputfield() {
      selectedvalue = document.getElementById("inputselect").value;
      // console.log(selectedvalue);
    }

    function createdfield() {
      let inputattribute = {};
      currentoptions = [];
      let newinput = document.createElement("input");

      newinput.setAttribute("type", selectedvalue);

      for (i = 0; i < attributedata1.length; i++) {
        let att = attributedata1[i].inf;
        let val = document.getElementById(att).value;
        inputattribute[att] = val;

        newinput.setAttribute(attributedata1[i].inf, val);
      }

      // for (i = 0; i < data1.length; i++) {
      //   let labelnew = document.createElement("label");
      //   labelnew.innerHTML = data1[i].name;
      //   resultcontainer.append(labelnew);

      //   console.log(labelnew);
      // }

      sub1.innerHTML = "Submit";
      sub1.style.margin = "20px";
      sub1.addEventListener("click", (e) => submitdata1(e));

      // if (selectedvalue !== "radio") {
      resultcontainer.append(newinput);
      resultcontainer.append(document.createElement("br"));
      displaytable.append(sub1);
      data1.push(inputattribute);
      data.push(newinput);
      // optionstore.push({ inputattribute });
      // myobject.push(inputattribute, options);
      myobject.push({
        inputattribute,
        options: currentoptions,
      });

      console.log(myobject);
      // console.log(inputattribute);
      // console.log(newinput);
      // console.log(data1);
      // console.log(data);
      // // }

      document.getElementById("name").value = "";
      document.getElementById("value").value = "";
      document.getElementById("id").value = "";
    }

    function createtable() {
      table.innerHTML = "";
      document.getElementById("displaytable").append(table);
      let thead = document.createElement("thead");
      for (i = 0; i < data1.length; i++) {
        let th = document.createElement("th");
        // th.innerHTML = data1[i].nameval;
        th.innerHTML = data1[i].name;
        th.style.border = "1px solid black";
        thead.append(th);
        table.append(thead);
        table.append(tbody);
      }
      let th1 = document.createElement("th");
      th1.innerHTML = "Actions";
      th1.style.border = "1px solid black";
      thead.append(th1);

      triggertable();
    }

    function triggertable() {
      tbody.innerHTML = "";
      let tr = document.createElement("tr");

      for (i = 0; i < data.length; i++) {
        let td = document.createElement("td");
        td.style.border = "1px solid black";
        td.innerHTML += data[i].value;
        tr.append(td);
        tbody.append(tr);
      }
      let td1 = document.createElement("td");
      td1.style.border = "1px solid black";
      let editbtn = document.createElement("button");
      editbtn.innerHTML = "Edit";
      editbtn.style.marginRight = "5px";

      let deletebtn = document.createElement("button");
      deletebtn.innerHTML = "Delete";

      td1.append(editbtn);
      td1.append(deletebtn);
      tr.append(td1);
      table.append(tbody);
    }

    function submitdata1(e) {
      e.preventDefault();
      createtable();
    }

    createinput();
  </script>
</html>
